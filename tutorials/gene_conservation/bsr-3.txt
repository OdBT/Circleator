# read BSR output and assign aliases to the two query genomes ("Cm", "Cp")
new load_bsr1 load-bsr heightf=0,bsr-file=./Cc_GPIC_Cm_Nigg_Cp_AR39.txt,genome1=Cm,genome2=Cp

# expand each BSR region by 25X 
new bsr_cm_d bsr 0 threshold=0.4,genomes=Cm|Cp,signature=10,color1=none,color2=none
new ssl1 scaled-segment-list feat-track=bsr_cm_d,scale=25
# highlight expanded regions
new hssl1 rectangle feat-track=ssl1,opacity=0.2,innerf=0.32,outerf=1.1,color1=#909090,color2=black

# label genes with locus and gene id
small-label lg1 innerf=1.12,label-function=locus,feat-track=bsr_cm_d,packer=none,label-type=spoke
small-label lg2 innerf=1.22,label-function=tag,tag-name=gene,feat-track=bsr_cm_d,packer=none,label-type=spoke

tiny-cgap outerf=1.0
genes
# highlight conserved hypotheticals
new HCH rectangle feat-type=CDS,feat-tag=product,feat-tag-regex=hypothetical\sprotein,innerf=same,outerf=same,opacity=0.8,color1=#00ff00
medium-label label-text=all&nbsp;genes&nbsp;/&nbsp;green:hypothetical&nbsp;proteins
small-cgap

# genes that are present in all 3 genomes
new CH1 rectangle color1=none,color2=#000000,heightf=0.14,feat-type=contig
tiny-cgap outerf=same
new bsr_all bsr 0.07 threshold=0.4,genomes=Cm|Cp,signature=11,color1=#a0a0a0,color2=#a0a0a0
# genes that are unique to the reference
new bsr_ref bsr 0.07 threshold=0.4,genomes=Cm|Cp,signature=00,color1=#f91919,color2=#f91919,innerf=same
medium-label label-text=grey:conserved&nbsp;in&nbsp;all&nbsp;3&nbsp;/&nbsp;red:unique&nbsp;to&nbsp;C.&nbsp;caviae&nbsp;GPIC
medium-cgap

# genes that are present only in the reference and Chlamydophila pneumoniae AR39
new CH1 rectangle color1=none,color2=#000000,heightf=0.14,feat-type=contig
tiny-cgap outerf=same
new bsr_cp bsr 0.07 threshold=0.4,genomes=Cm|Cp,signature=01,color1=#c411be,color2=#c411be
medium-label label-text=ONLY&nbsp;found&nbsp;in&nbsp;C.&nbsp;caviae&nbsp;GPIC&nbsp;and&nbsp;C.&nbsp;pneumoniae&nbsp;AR39m
medium-cgap

# genes that are present only in the reference and Chlamydia muridarum Nigg
new CH2 rectangle color1=none,color2=#000000,heightf=0.14,feat-type=contig
tiny-cgap outerf=same
new bsr_cm bsr 0.07 threshold=0.4,genomes=Cm|Cp,signature=10,color1=#1511c4,color2=#1511c4
medium-label label-text=ONLY&nbsp;found&nbsp;in&nbsp;C.&nbsp;caviae&nbsp;GPIC&nbsp;and&nbsp;C.&nbsp;muridarum&nbsp;Nigg

# connect outer scaled circle to inner unscaled circle
new hssl2 rectangle innerf=0.22,outerf=0.32,feat-track=ssl1,opacity=0.2,color1=#909090,color2=black,stroke-width=1,inner-scale=none,outer-scale=default

# restore unscaled coordinates
new SSLR scaled-segment-list scale=1,feat-type=dummy

# inner (unscaled) circle
coords innerf=0.22,heightf=0.008
tiny-cgap

# repeat all genes/hypotheticals track
genes heightf=0.03
# highlight conserved hypotheticals
new HCH rectangle feat-type=CDS,feat-tag=product,feat-tag-regex=hypothetical\sprotein,innerf=same,outerf=same,opacity=0.8,color1=#00ff00

